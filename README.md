# BackTest
Quantitative trade back-test platform

# 回测框架

## 数据模块：datafeed
### datafeed类，作为回测引擎
负责数据读取，清理，转换

1. 读取股票日度交易csv文件或者股指高频数据（支持universe='allA' 'zz500' 股票列表三种选择，不可更改）
2. 记录当前时间t
3. 返回数据库中的所有时间点
4. 返回当前一期观测值ohlcv，并更新当前时间t+1，以防使用未来数据

## 策略模块：strat
### strat类
负责策略计算和信号输出

1. 从datafeed中获取数据，管理时间序列数据流，**捕获新值释放旧值**（指标计算跨度n和延时l）。
2. 输入策略逻辑，计算指标数值
3. 根据指标，给出交易指令信号
4. 信号signals，取值为(id,1,0,-1)，分别表示buy,hold,sell

## 交易模块：broker
### broker类
负责接收并处理交易指令，包括模拟成交情况（如有），计算交易成本（非必须），计算交易冲击成本（非必须）

1. 获取来自strat的交易信号，获取port的前一交易日的持仓，获取内部的前一日未完成交易
2. 根据前一日未完成交易信号更新来自strat的交易信号
3. 根据涨跌停处理交易信号，产生可执行交易和延迟交易
4. 根据前一日的持仓和交易信号计算当前持仓
5. 计算成交金额
6. 计算手续费金额

## 组合模块：portfolio
### port类
负责动态计算

1. 获取来自broker的交易结果，更新当前仓位，现金量
2. 更新每日盈亏
3. 更新个股持仓时间
4. 更新其他跟踪数据

## 回测表现模块：analyzer
### analyzer类
负责分析策略表现，提供净值曲线，年化收益率，年化波动率，最大回撤等指标的计算和输出

1. 计算评价指标
2. 图形展示
3. 制作回测报告

## 风控模块：risk
### risk类
根据实时数据返回当前情况下的账户风险指标，包括资金使用情况、剩余资金量、杠杆率、VaR这些信息。

1. 获取来自port的持仓信息
2. 计算资金使用情况，杠杆率，剩余资金
3. 计算日度VaR




